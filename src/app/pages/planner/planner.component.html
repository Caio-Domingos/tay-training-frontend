<section id="planner" *ngIf="planner !== null">
  <!-- Header -->
  <div class="header">
    <!-- Nome do treino -->
    <h1 class="title">Ficha de treino | Academia</h1>

    <h2 class="planner-title">{{ planner!.publicName }}</h2>
  </div>

  <div class="div" id="table">
    <!-- Tabela de treinos -->

    <table>
      <thead>
        <th>X</th>
        <th>Sem. 1</th>
        <th>Sem. 2</th>
        <th>Sem. 3</th>
        <th>Sem. 4</th>
      </thead>

      <tbody>
        <tr>
          <td>Domingo</td>
          <td *ngFor="let item of mountTable(1)">
            {{
              item === null || item === undefined
                ? "FOLGA"
                : getExerciseSetName(item.exerciseGroupId)
            }}
          </td>
        </tr>
        <tr>
          <td>Segunda</td>
          <td *ngFor="let item of mountTable(2)">
            {{
              item === null || item === undefined
                ? "FOLGA"
                : getExerciseSetName(item.exerciseGroupId)
            }}
          </td>
        </tr>
        <tr>
          <td>Terça</td>
          <td *ngFor="let item of mountTable(3)">
            {{
              item === null || item === undefined
                ? "FOLGA"
                : getExerciseSetName(item.exerciseGroupId)
            }}
          </td>
        </tr>
        <tr>
          <td>Quarta</td>
          <td *ngFor="let item of mountTable(4)">
            {{
              item === null || item === undefined
                ? "FOLGA"
                : getExerciseSetName(item.exerciseGroupId)
            }}
          </td>
        </tr>
        <tr>
          <td>Quinta</td>
          <td *ngFor="let item of mountTable(5)">
            {{
              item === null || item === undefined
                ? "FOLGA"
                : getExerciseSetName(item.exerciseGroupId)
            }}
          </td>
        </tr>
        <tr>
          <td>Sexta</td>
          <td *ngFor="let item of mountTable(6)">
            {{
              item === null || item === undefined
                ? "FOLGA"
                : getExerciseSetName(item.exerciseGroupId)
            }}
          </td>
        </tr>
        <tr>
          <td>Sábado</td>
          <td *ngFor="let item of mountTable(7)">
            {{
              item === null || item === undefined
                ? "FOLGA"
                : getExerciseSetName(item.exerciseGroupId)
            }}
          </td>
        </tr>
      </tbody>
    </table>

    <h3 class="about-table">
      <i>
        Essa tabela é uma sugestão de como organizar seus treinos na semana.
      </i>
    </h3>
  </div>

  <!-- Lista de treinos -->
  <div class="workouts">
    <div
      class="workout"
      *ngFor="let item of getDistinctWorkouts(); let i = index"
    >
      <!-- Treino  -->

      <h3>
        {{ getExerciseSetName(item!.exerciseGroupId) }} -
        {{
          item?.exerciseGroup?.publicName
            ? item?.exerciseGroup?.publicName
            : item?.exerciseGroup?.name
        }}
      </h3>

      <mat-accordion>
        <mat-expansion-panel
          *ngFor="
            let workout of item?.exerciseGroup?.exerciseMethods;
            let iw = index
          "
        >
          <mat-expansion-panel-header>
            <mat-panel-title>
              <!-- Collapse Nome do treino/combinação -->
              {{ "Exercício " + (iw + 1) }} -
              {{ getWorkoutMultiName(item!.exerciseGroupId!, workout.id!) }}
            </mat-panel-title>
          </mat-expansion-panel-header>
          <!-- {{ workout.method | json }} -->

          <!-- Tempo de descanso -->
          <p class="rest">Tempo de descanso: {{ workout?.rest }}</p>
          <!-- Observações -->
          <p class="obs" *ngIf="workout.observations">
            Sobre o exercicio: {{ workout?.observations }}
          </p>

          <hr class="divider-1" />

          <!-- Exercicios -->
          <!-- Collapse Exercicio -->

          <mat-expansion-panel
            [hideToggle]="false"
            *ngFor="let exercise of workout.exerciseConfigurations"
          >
            <mat-expansion-panel-header>
              {{ exercise.exercise?.name }}
            </mat-expansion-panel-header>

            <!-- Exercicio Desc -->
            <p>Descrição{{ exercise.exercise?.description }}</p>
            <!-- Exercicio Series/Reps -->
            <!-- Metodo -->
            <ng-container *ngIf="exercise?.method">
              <p class="method">Método: {{ exercise?.method?.name }}</p>
            </ng-container>
            <p>Série/Repetição: {{ exercise.series }} x {{ exercise.reps }}</p>

            <!-- Video -->
            <!-- Collapse -->
            <div class="video">
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title>Video Explicativo</mat-panel-title>
                </mat-expansion-panel-header>
                <!-- Iframe resposnsivo -->
                <div class="iframe-container">
                  <iframe
                    width="560"
                    height="315"
                    [src]="secIframeLink(exercise.id!)"
                    frameborder="0"
                    allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                  ></iframe>
                </div>
                <!-- Iframe resposnsivo -->
              </mat-expansion-panel>
            </div>
          </mat-expansion-panel>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
  </div>

  <div class="offline" *ngIf="planner.offlinePdf || planner.newTabPdf">
    <button
      mat-raised-button
      color="primary"
      (click)="newTabPDF()"
      *ngIf="planner.newTabPdf"
    >
      Abrir PDF
    </button>

    <button
      mat-raised-button
      color="primary"
      (click)="downloadPDF()"
      *ngIf="planner.offlinePdf"
    >
      Baixar PDF
    </button>
  </div>
</section>
